package com.MovieLens.Recommend;

import java.io.File;
import java.io.IOException;
import java.util.List;

import org.apache.mahout.cf.taste.common.TasteException;
import org.apache.mahout.cf.taste.impl.common.LongPrimitiveIterator;
import org.apache.mahout.cf.taste.impl.model.file.FileDataModel;
import org.apache.mahout.cf.taste.impl.recommender.GenericItemBasedRecommender;
import org.apache.mahout.cf.taste.impl.similarity.LogLikelihoodSimilarity;
import org.apache.mahout.cf.taste.model.DataModel;
import org.apache.mahout.cf.taste.recommender.RecommendedItem;
import org.apache.mahout.cf.taste.similarity.ItemSimilarity;

/**
 * @author Savani Bharat
 *
 */
public class ItemRecommender {

	public static void main(String[] args) {

		try {
			DataModel dm = new FileDataModel(new File("data/movies.csv"));
			ItemSimilarity sim = new LogLikelihoodSimilarity(dm);

			GenericItemBasedRecommender recommender = new GenericItemBasedRecommender(
					dm, sim);
			int x = 1;
			for (LongPrimitiveIterator items = dm.getItemIDs(); items.hasNext();) {
				
				long itemId = items.nextLong();
				List<RecommendedItem> recommendations = recommender.mostSimilarItems(itemId, 5);

				for (RecommendedItem recommendation : recommendations) {

					System.out.println(itemId + " "
							+ recommendation.getItemID() + " "
							+ recommendation.getValue());

				}
				x++;
				if(x>100)
					System.exit(1);
			}
		} catch (IOException | TasteException e) {

			e.printStackTrace();
		}

	}
}
/**
 * Output
1 117 0.9953521
1 151 0.9953065
1 121 0.9952347
1 405 0.99500656
1 50 0.99491894
2 403 0.9964998
2 233 0.9964557
2 161 0.9961404
2 231 0.9960143
2 385 0.9959657
3 405 0.99037176
3 235 0.9893157
3 121 0.9880421
3 250 0.9880041
3 100 0.98773706
4 56 0.99627966
4 174 0.99601305
4 204 0.9959589
4 202 0.99582237
4 385 0.9957967
5 218 0.99432045
5 98 0.9922024
5 234 0.99179345
5 56 0.99115413
5 53 0.9909523
6 547 0.97414243
6 923 0.97221303
6 221 0.97155356
6 1129 0.9711365
6 14 0.96929955
7 117 0.9955004
7 100 0.99548376
7 405 0.99411255
7 121 0.99411076
7 273 0.99403757
8 204 0.9952286
8 71 0.99448764
8 69 0.9944172
8 423 0.9943667
8 173 0.99416584
9 276 0.99450094
9 100 0.9936224
9 508 0.9910352
9 237 0.99008524
9 124 0.99006104
10 20 0.98759043
10 713 0.9847893
10 582 0.9836043
10 13 0.98339003
10 190 0.9832126
11 56 0.9965508
11 22 0.9963229
11 96 0.9959787
11 79 0.9959084
11 174 0.9957283
12 56 0.9964165
12 98 0.9956322
12 64 0.99555105
12 11 0.9955026
12 174 0.99520767
13 100 0.9917786
13 14 0.9905319
13 124 0.9904908
13 25 0.9902755
13 111 0.9895404
14 285 0.9940889
14 275 0.99387044
14 116 0.9924065
14 137 0.9919663
14 19 0.990724
15 237 0.99441165
15 1 0.99253607
15 25 0.9925052
15 111 0.99227524
15 121 0.9921375
16 116 0.9773587
16 137 0.97702163
16 1115 0.97680646
16 129 0.97664285
16 20 0.9760947
17 68 0.99384123
17 231 0.99322075
17 53 0.99281615
17 184 0.99228555
17 56 0.99195695
18 30 0.96384585
18 149 0.96096206
18 224 0.96073824
18 1535 0.95966464
18 1158 0.95966464
19 14 0.990724
19 116 0.9897758
19 285 0.9893509
19 275 0.9884273
19 20 0.98630494
20 116 0.98924387
20 14 0.98900294
20 285 0.98803806
20 10 0.98759043
20 137 0.9872712
21 473 0.9875841
21 151 0.98443097
21 1028 0.98393106
21 95 0.98374945
21 1 0.9828682
22 174 0.99704474
22 69 0.99672085
22 172 0.9967002
22 11 0.9963229
22 195 0.9962465
23 182 0.9947838
23 187 0.99473923
23 179 0.99440646
23 98 0.99432814
23 192 0.9943154
24 455 0.99440145
24 405 0.9938495
24 117 0.993012
24 7 0.99267924
24 121 0.99260557
25 121 0.99399483
25 405 0.9938031
25 237 0.99343705
25 111 0.99338174
25 1 0.9929051
26 381 0.9889748
26 70 0.9880817
26 732 0.9876871
26 88 0.9872275
26 655 0.98689896
27 231 0.99226993
27 68 0.9913321
27 17 0.9910117
27 578 0.9910117
27 576 0.99093544
28 423 0.9971849
28 69 0.9971152
28 174 0.99684644
28 204 0.99663866
28 196 0.9963501
29 403 0.99679446
29 231 0.9966004
29 550 0.995721
29 82 0.9955818
29 62 0.995553
30 212 0.987407
30 529 0.9861981
30 59 0.9861317
30 198 0.98525274
30 60 0.98481035
31 69 0.99509454
31 22 0.9947031
31 423 0.9943056
31 96 0.9942932
31 28 0.9942319
32 175 0.99025667
32 23 0.98988146
32 209 0.9898074
32 182 0.9886324
32 357 0.9885934
33 68 0.994741
33 550 0.9936414
33 385 0.9935981
33 233 0.9929036
33 96 0.99286836
34 57 0.96000737
34 17 0.95787734
34 92 0.9550568
34 215 0.9547027
34 235 0.95401144
35 78 0.98730755
35 94 0.9773852
35 140 0.97584426
35 768 0.9722184
35 465 0.9715315
36 794 0.97587204
36 724 0.97438097
36 29 0.9735156
36 51 0.9734784
36 66 0.9732149
37 29 0.9716817
37 61 0.9711822
37 217 0.97098315
37 145 0.96994793
37 2 0.96970856
38 161 0.99559504
38 568 0.99550575
38 385 0.995205
38 226 0.9951072
38 550 0.99485123
39 96 0.9917823
39 4 0.9912394
39 228 0.9911483
39 11 0.99111885
39 12 0.9909262
40 393 0.99197924
40 451 0.98990154
40 72 0.9887641
40 161 0.9884103
40 747 0.98822534
41 67 0.991371
41 401 0.99114984
41 80 0.99043465
41 780 0.98958844
41 94 0.98956966
42 204 0.9939247
42 56 0.99384445
42 238 0.99382675
42 168 0.99322814
42 12 0.99320376
43 54 0.989104
43 215 0.9887995
43 77 0.9884624
43 161 0.98843294
43 402 0.988231
44 234 0.99287254
44 77 0.9926849
44 218 0.9913276
44 54 0.99102056
44 559 0.9908241
45 462 0.990837
45 170 0.9904613
45 60 0.9869264
45 179 0.98663497
45 86 0.98652655
46 715 0.98439384
46 198 0.9836819
46 175 0.9828549
46 92 0.98240435
46 558 0.9810419
47 168 0.9944156
47 238 0.99416494
47 209 0.99370515
47 4 0.9935556
47 186 0.9933545
48 64 0.9925133
48 180 0.99212164
48 318 0.99190366
48 12 0.99106926
48 58 0.9908959
49 393 0.9939711
49 88 0.99359715
49 202 0.9934404
49 781 0.9927845
49 732 0.9927454
50 181 0.9982376
50 172 0.996748
50 174 0.99657804
50 210 0.9955421
50 195 0.99510145
51 97 0.9928743
51 655 0.99286455
51 402 0.9928506
51 451 0.99220437
51 161 0.9921306
52 70 0.99197
52 83 0.9919506
52 170 0.99168414
52 191 0.9916824
52 86 0.9916368
53 218 0.99524885
53 217 0.99510866
53 559 0.9950023
53 56 0.99470985
53 226 0.99466705
54 226 0.9954212
54 77 0.9954065
54 566 0.99490285
54 385 0.99441224
54 550 0.9944008
55 195 0.994685
55 56 0.99465466
55 96 0.9945394
55 68 0.9945315
55 11 0.9942896
56 98 0.9972433
56 174 0.99722713
56 204 0.9970651
56 195 0.9967598
56 79 0.996755
57 462 0.9856397
57 52 0.9839887
57 382 0.9827772
57 86 0.9827608
57 582 0.98241323
58 69 0.9959426
58 423 0.9956615
58 64 0.9955166
58 196 0.9953359
58 735 0.9950894
59 60 0.99619484
59 61 0.9960204
59 170 0.9914064
59 462 0.98989457
59 198 0.9883325
60 59 0.99619484
60 61 0.9954696
60 170 0.99181145
60 198 0.9887312
60 462 0.9883616
61 59 0.9960204
61 60 0.9954696
61 462 0.9901322
61 198 0.98977107
61 170 0.9889572
62 403 0.9963918
62 385 0.99635726
62 68 0.99617344
62 226 0.99615085
62 227 0.99606556
63 393 0.9953187
63 94 0.99490863
63 88 0.993462
63 67 0.99303627
63 403 0.99301606
64 69 0.99641466
64 174 0.99624765
64 318 0.99592185
64 22 0.99587035
64 56 0.9958309
65 69 0.9935467
65 216 0.9925275
65 58 0.99211997
65 423 0.9918315
65 393 0.99176544
66 88 0.99656546
66 204 0.99554706
66 202 0.99539936
66 393 0.99521714
66 216 0.9951535
67 94 0.99598116
67 80 0.99530745
67 393 0.9951063
67 72 0.9951006
67 780 0.9948333
68 550 0.9964703
68 403 0.9963773
68 385 0.9962386
68 231 0.9962311
68 62 0.99617344
69 423 0.99744195
69 174 0.9973395
69 204 0.99720025
69 97 0.9971363
69 28 0.9971152
70 216 0.99622595
70 204 0.9961171
70 69 0.99506706
70 88 0.9950585
70 97 0.9949778
71 95 0.99753875
71 588 0.99679554
71 172 0.9965219
71 69 0.9964612
71 82 0.9964571
72 393 0.9956391
72 403 0.9954052
72 67 0.9951006
72 367 0.994625
72 204 0.9945666
73 393 0.99472165
73 204 0.9946817
73 88 0.99452823
73 173 0.9941865
73 161 0.9941201
74 218 0.96022606
74 436 0.95623225
74 200 0.95552623
74 175 0.9552524
74 675 0.9543197
75 1437 0.9571394
75 219 0.9557473
75 35 0.95435107
75 548 0.95306385
75 94 0.95109797
76 69 0.990329
76 195 0.9902582
76 188 0.9900859
76 187 0.9899883
76 58 0.9898201
77 161 0.99549747
77 54 0.9954065
77 566 0.9949752
77 82 0.9948972
77 226 0.9947459
78 94 0.99034125
78 71 0.98759866
78 35 0.98730755
78 393 0.98652804
78 395 0.9859971
79 174 0.9973227
79 96 0.99706495
79 568 0.99691355
79 172 0.9967733
79 56 0.996755
80 67 0.99530745
80 384 0.9941583
80 94 0.9936511
80 386 0.9936444
80 393 0.99324805
81 64 0.9936793
81 238 0.9935961
81 186 0.99353
81 425 0.99326557
81 655 0.9931946
82 161 0.99761665
82 568 0.997378
82 172 0.997371
82 385 0.9973635
82 174 0.99719757
83 190 0.99398446
83 173 0.9938364
83 168 0.9935972
83 86 0.993231
83 70 0.9929205
84 82 0.9792397
84 67 0.9785067
84 139 0.97760355
84 404 0.97523475
84 403 0.97489566
85 4 0.991571
85 72 0.98983645
85 732 0.98968357
85 202 0.9892943
85 70 0.98924196
86 387 0.9935432
86 70 0.993264
86 83 0.993231
86 736 0.9931506
86 213 0.99304956
87 28 0.9929744
87 191 0.9929744
87 204 0.9927856
87 174 0.99269575
87 196 0.9926167
88 202 0.996947
88 393 0.99672467
88 216 0.99657774
88 66 0.99656546
88 204 0.9964364
89 174 0.9973093
89 172 0.99688476
89 183 0.99685633
89 96 0.99682987
89 228 0.9967607
90 367 0.9935135
90 72 0.9933439
90 168 0.9931782
90 393 0.99314994
90 386 0.99314237
91 588 0.99541616
91 71 0.99488884
91 432 0.99482447
91 95 0.9947737
91 82 0.9947186
92 11 0.9939876
92 182 0.9938638
92 56 0.99352753
92 4 0.9932988
92 55 0.99314547
93 475 0.9919959
93 7 0.99145573
93 100 0.9898981
93 508 0.988614
93 919 0.9885271
94 393 0.99685144
94 67 0.99598116
94 403 0.99536824
94 82 0.99527603
94 88 0.9951642
95 71 0.99753875
95 588 0.99723095
95 82 0.99655706
95 204 0.99648565
95 99 0.9963507
96 195 0.99794465
96 172 0.99726915
96 174 0.99725306
96 79 0.99706495
96 385 0.9970298
97 69 0.9971363
97 423 0.99679434
97 215 0.99644446
97 196 0.9964219
97 172 0.9963834
98 56 0.9972433
98 174 0.9971827
98 234 0.99712116
98 176 0.9969522
98 69 0.99675626
99 588 0.9969216
99 418 0.99660635
99 432 0.99659824
99 95 0.9963507
99 404 0.99622107
100 7 0.99548376
100 276 0.9938738
100 475 0.99376225
100 9 0.9936224
100 12 0.99355376

 */
